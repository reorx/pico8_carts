pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- davis
-- print("davis lf2")

davis_type = {}

function davis_type:new(tx, ty)
    local davis = {
        tx = tx,
        ty = ty,
        dx = 0,
        dy = 0,
        width = 2,
        height = 2,
        spr = 0,
        spr_w = 2,
        spr_h = 2,
        spr_flip_x = false,
        spr_flip_y = false,
        frame = 0,
        frames = 2,
        ticks_per_frame = 3,
        inertia = 0.8,
        moveunit = 0.06,
        tick = 0,
    }
    self.__index = self
    return setmetatable(davis, self)
end

function davis_type:update()
    -- frame
    self.frame = flr(self.tick / self.ticks_per_frame) % self.frames
    -- tick
    self.tick += 1
end

function davis_type:set_state(state)
    if state == "stand" then
        self.spr = 128
        self.frames = 4
    elseif state == "walk" then
        self.spr = 136
        self.frames = 4
    elseif state == "hadouken" then
        self.spr = 0
        self.frames = 7
    elseif state == "shoryuken" then
        self.spr = 64
        self.frames = 8
    end
end


function davis_type:draw()
    local x = self.tx * 8
    local y = self.ty * 8
    spr(self.spr + (self.frame * self.spr_w), x, y, self.spr_w, self.spr_h, self.spr_flip_x, self.spr_flip_y)
end

-- pico8 functions

function _init()
    davis = davis_type:new(5, 5)
    davis:set_state("walk")
end

function _update()
    davis:update()
    if btn(5) then
        davis:set_state("hadouken")
    elseif btn(4) then
        davis:set_state("shoryuken")
    end
end

function _draw()
    cls()
    rectfill(0,0, 127,127, 1)
    davis:draw()
end

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000005000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000011000000000000000000000000
00000500550000000000050055000000000000055555000000000055555100000000055555000000000000555550000000000051555000000000000000000000
00000055550000000000005505000000000000500050000000000051115100000000051055000000000000011550000000000015155000000000000000000000
0000044d400000000000044d50000000000000005450000000000001dd1000000000005dd0000000000000556d00000000000044d50000000000000000000000
00000596d0000000000005966000000000000004f75000000000000477000000000005a7d00000000000005f7d0000000000004f650000000000000000000000
0000115ad10000000000115ad100000000000011d6555100000000156651d100000001d6d551000000000114fd0000000000011efd0000000000000000000000
0000d1cfdc00000000016dcfdc0000000000011111677100000001111c767710000111116775d6100000066ded1000000000d6ddeddd00000000000000000000
000176d6d6600000000177c6dd710000000001111d1d1000000001111cd166100000111d1d501d10000005f76d7100000000576c6d6f00000000000000000000
0000dfd5dde0000000000dddd1650000000000155d00000000000015dd0001000000151d000000000000005dd55100000000005dd10000000000000000000000
000005d5d5000000000001d5550000000000005d5dd000000000005dddd0000000005dddd0000000000000555d0000000000005d5d1000000000000000000000
000005555d000000000005555d1000000000015d55d100000000015d55d1000000005d55d5000000000001dd5dd00000000001dd5dd000000000000000000000
00000155150000000000015515100000000001550151000000000155015100000001550055000000000001550151000000000155015100000000000000000000
00001d501510000000001d500550000000001d500055000000001d5000550000000551005510000000001d500055000000001d50005500000000000000000000
00000510011000000000055001500000000005500015100000000550001510000005500005100000000005500015100000000550001510000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000010000000000000110000000000000100000000000000000010000000000000110000000000000110000000000000000000000000000000000000000
00000005555500000000055555100000000555551000000000000005555500000000005155100000000055555100000000000000000000000000000000000000
0000000000550000000000501d10000000000105500000000000000000550000000000001d10000000000501d100000000000000000000000000000000000000
00000004455000000000054dd1000000000544550000000000000004455000000000054dd5000000000044551000000000000000000000000000000000000000
00000009ff000000000004a6600001000005a6600000000000000009ff000000000005966000000000004f7d0000000000000000000000000000000000000000
00000115af1dd7d00001114fd1ddd6d000114f61ddf5161000000115af1000000000114f6100000000111e7d1000000000000000000000000000000000000000
000057d1fdcc76d000067ddfdc6667d00d7dcfdc67651d10000057d1fdcc66d0000d7d1fdc66dd100066cdfcc66d100000000000000000000000000000000000
00001fe1661000000005fdc7d000111001fdc7d00000000000001fe16d1d67600001fdc6d1d667c000dfdc611d7ed61000000000000000000000000000000000
0000001ddd000000000001d6d00000000001d6d0000000000000001ddd000010000001d6d0001d1000001d610000111000000000000000000000000000000000
0000005d5d50000000000dddd10000000005d5d5000000000000005d5d500000000005d5d50000000001d55d1000000000000000000000000000000000000000
0000005d55d1000000001dd5dd000000001dd55d100000000000005d55d1000000001dd5561000000005dd5dd000000000000000000000000000000000000000
0000015501510000000015501d1000000015501510000000000001550151000000001550151000000015d1055000000000000000000000000000000000000000
00001d50005500000001d5000550000001d500055000000000001d50005500000001d50005500000005d10015500000000000000000000000000000000000000
00000550001510000001510001500000015100015000000000000550001510000000550001510000005500005500000000000000000000000000000000000000
00000000000000000000000001d100000000000167100000000000dd1000000000000000d5000000000004400000000000000000000000000000000000000000
0000000000000000000000000d771000000000016771000000000067610000000000000d7600000000000ff00000000000000000550000000000055550000000
0000055550000000000005511d77d00000000515667600000000005676000000000000067d000000000057505500000000000050550000000000050055000000
0000000155000000000005150677d00000005115677710000000050d761000000000005d7d0000000000dd100500000000000555555000000000051555000000
000004455510000000000044d6775000000001ddd676d000000000566cd100000000001c6d50000000001cd10010000000000110550000000000054d50500000
000004f6d57610000000009f6d771000000004f6dd7d1000000000f6ddd100000000001dc6500000000001d111c1000000001d11500000000000114fd6f00000
000012971d7710000000005edc7710000000014ec67d00000000004dcd1000000000005dcdd0000000000111cccd00000000111dc1100000000011dff6000000
00011691d67d0000000001c1cc771000000001ddc671000000004d11dc10000000000011dcc1000000000011dc100000000011dd1c600000000111d6d0000000
005f66d11660000000004ddd1177000000005dcc16710000000046dddc100000000000111ccd000000000015d5000000000011111d500000000011dd00000000
0005ddd1110000000000555d1067000000004ddd166100000000005dd1000000000000011dd1000000000055550000000000555100000000000015d550000000
000005d5000000000000555d50d600000000151d1dd000000000155dd01100000000015dd5110000000000555500000000000555000000000000055551000000
0000551d100000000000555d001100000000555d1dd000000000155510000000000001dd55100000000000551100000000001515100000000000005510000000
00005101500000000000115100000000000011550110000000000055000000000000015500000000000000151000000000001555100000000000005550000000
000550005100000000005550000000000000155001000000000001d1000000000000005500000000000000110000000000000015500000000000001d10000000
005d1001d50000000000150000000000000005500000000000000150000000000000015100000000000000000000000000000000000000000000000100000000
00000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001500000011000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000d7761001d7760011667d0000000111cd66d100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00c7677601c7677d0c6767760000011cc77677750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0017767d00c7677d0c67677d0000011cc77677750000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000d7760000d76d0001d66d00000000111dddd100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000005500000000000000555000000000000555500000000000055550000000000005555000000000000555500000000000005550000000000000550000000
00000500555000000000050005500000000005000500000000000500050000000000050005000000000005000500000000000500055000000000050055500000
00000054550000000000005455000000000000545500000000000054550000000000005455000000000000545500000000000054550000000000005455000000
00000596d000000000000596600000000000059660000000000005966000000000000596600000000000059660000000000005966000000000000596d0000000
0000014ff00000000000014ff00000000000014af00000000000014af00000000000014af00000000000014af00000000000014ff00000000000014ff0000000
00001119e100000000001119e10000000000111ee10000000000111ee10000000000111ee10000000000111ee100000000000119e100000000000119e1000000
00001116dc100000000011166c10000000001d166c10000000001d166c10000000001d166c10000000001c166c00000000000dc66c00000000000dc661000000
0000dd16dc1000000000dd16dc50000000006d16ddd0000000006d16ddd0000000006d16ddd0000000005616dd10000000000d666d0000000000056661000000
0000f51d566000000000f51d5ff000000000f5555ff000000001f5555ff000000001f5555ff000000000df555f500000000005fdd5000000000000ffd5000000
0000455554400000000045555440000000005155d4500000000051d5d450000000005055545000000000555d5d0000000000004dd50000000000005dd5000000
0000015555000000000001555500000000000155550000000000055555000000000000555100000000000055d10000000000015555000000000001555d000000
00000155150000000000015515000000000001551500000000000155150000000000001550000000000000155000000000000115550000000000051115100000
00000550151000000000055005500000000005501510000000000550151000000000001551000000000000155000000000000155150000000000055005500000
00000550011000000000055001100000000005500110000000000550011000000000000110000000000000155000000000000055151000000000015001000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001000500000550000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000050000500050000510055001500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000050000050000000500000005500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000005000005500000500000055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10000000015001555000000000550050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005000000500005000550500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000055555000055555005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0100000050044eeee441000555055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000044444fffff440050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000054444efffffff5050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00001005054444ffffffffe500010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000044000545005dfffffff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000445004455000046fffd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000054401444d5155004f10550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000044054446d57744f50d600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000054444444effff4fd5f500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000004444444ffffe4fdff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000005444444efffe4fdff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000004444444efffe4e4f4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000544444444efffe44f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000544444444eeddde7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000004444444444efffff10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000115444454444ee4e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011114444444eee4ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000111111544454ef771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011111115494554410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0111111111111ef45010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111101111111df4011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111df4011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111ff4011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111011111111ff4011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111101111111df441111d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
